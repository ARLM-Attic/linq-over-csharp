// ================================================================================================
// Token.cs
//
// Created: 2009.05.21, by Istvan Novak (DeepDiver)
// ================================================================================================
namespace CSharpTreeBuilder.CSharpAstBuilder
{

  // ==================================================================================
  /// <summary>
  /// This class defines a Token used by the scanner and the parser.
  /// </summary>
  /// <remarks>
  /// This class defines public fields that are against the convention not using public
  /// fields. Because wrapping this fields into properties would affect the performance
  /// we live together to violating the convention.
  /// </remarks>
  // ==================================================================================
  public class Token
  {
    // ----------------------------------------------------------------------------------------------
    /// <summary>Points to the next token.</summary>
    // ----------------------------------------------------------------------------------------------
    private Token _Next;

    // ----------------------------------------------------------------------------------------------
    /// <summary>
    /// Kind of token.
    /// </summary>
    // ----------------------------------------------------------------------------------------------
    public int Kind { get; internal set; }

    // ----------------------------------------------------------------------------------------------
    /// <summary>
    /// Token position in the source text (starting at 0).
    /// </summary>
    // ----------------------------------------------------------------------------------------------
    public int Position { get; internal set; }

    // ----------------------------------------------------------------------------------------------
    /// <summary>
    /// Token column (starting at 0).
    /// </summary>
    // ----------------------------------------------------------------------------------------------
    public int Column { get; internal set; }

    // ----------------------------------------------------------------------------------------------
    /// <summary>
    /// Token line (starting at 1).
    /// </summary>
    // ----------------------------------------------------------------------------------------------
    public int Line { get; internal set; }

    // ----------------------------------------------------------------------------------------------
    /// <summary>
    /// Token value.
    /// </summary>
    // ----------------------------------------------------------------------------------------------
    public string Value { get; internal set; }

    // ----------------------------------------------------------------------------------------------
    /// <summary>
    /// Points to the previous token.
    /// </summary>
    // ----------------------------------------------------------------------------------------------
    public Token Previous { get; private set; }

    //-----------------------------------------------------------------------------------
    /// <summary>
    /// Gets the next token.
    /// </summary>
    //-----------------------------------------------------------------------------------
    public Token Next
    {
      get { return _Next; }
      set
      {
        _Next = value;
        if (value != null) _Next.Previous = this;
      }
    }

    //-----------------------------------------------------------------------------------
    /// <summary>
    /// Gets the previous token.
    /// </summary>
    //-----------------------------------------------------------------------------------
    public Token prev
    {
      get { return Previous; }
    }
  }
}